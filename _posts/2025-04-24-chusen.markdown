---
layout: post
title: ç™ºè¡¨é †æŠ½é¸é¢¨Webã‚¢ãƒ—ãƒªã‚’å…¬é–‹
date: 2025-04-24 23:00:00
description:  # Add post description (optional)
img: postimg/250424_main.png # Add image post (optional)
fig-caption: # Add figcaption (optional)
tags: [java]
---

æ˜¨æ—¥ã€[ç™ºè¡¨è€…ã®é †ç•ªã‚’æ±ºã‚ã‚‹Webã‚¢ãƒ—ãƒª](https://liqrase.net/chusen/chusen)ã‚’å…¬é–‹ã—ãŸã®ã§ã€<br>
ãã‚Œã®ã‚³ãƒ¼ãƒ‰ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥ã‚ŒãŸã‚‚ã®ã‚’è¨˜ã—ã¾ã™ã€‚

### Servlet

ãƒšãƒ¼ã‚¸å…¥å£
```java
package controller;

import java.io.IOException;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;


@WebServlet("/chusen")
public class ChusenController extends HttpServlet {
	private static final long serialVersionUID = 1L;
    
	// /chusen ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ããŸã¨ãã«jspãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤º(URLã«.jspã¨è¡¨ç¤ºã•ã‚Œã‚‹ã®ã‚’é˜²ããŸã„ãŸã‚)
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		RequestDispatcher rd = request.getRequestDispatcher("/jsp/chusen.jsp");
		rd.forward(request, response);
	}
}
```

æŠ½é¸ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©
```java
package controller;

import java.io.IOException;
import java.io.PrintWriter;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.Collections;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.fasterxml.jackson.databind.ObjectMapper;

@WebServlet("/finalResult")
public class FinalResultServlet extends HttpServlet {

	// ãƒ—ãƒ­ã‚°ãƒ©ãƒ å†…ã®new ArrayList()ã§å‹æŒ‡å®šã—ã¦ã„ãªã„ã“ã¨ã«å¯¾ã—ã¦å‡ºã¦ãã‚‹è­¦å‘Šã«å¯¾ã—ã€
	// ã€Œåˆ†ã‹ã£ã¦ã¾ã™ã‚ˆã€ã¨ç¤ºã—é»™ã‚‰ã›ã‚‹ãŸã‚ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
	@SuppressWarnings("unchecked")
	@Override
	protected void doPost(HttpServletRequest request, HttpServletResponse response) 
			throws IOException {
		// Postã§å—ã‘å–ã£ãŸæƒ…å ±ã®æ–‡å­—åŒ–ã‘ã‚’é˜²ã
		request.setCharacterEncoding("UTF-8");
		// å‡ºåŠ›æ™‚ã®MIMEã‚¿ã‚¤ãƒ—(ãƒ‡ãƒ¼ã‚¿ã®ç¨®é¡)ã¨æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’æ±ºã‚ã‚‹
		response.setContentType("application/json; charset=UTF-8");

		// Javaã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ â‡„ JSONæ–‡å­—åˆ— ã‚’è‡ªç”±è‡ªåœ¨ã«å¤‰æ›ã§ãã‚‹ObjectMappeå‹ã‚’ç”Ÿæˆ
		ObjectMapper mapper = new ObjectMapper();
		
		// mapper.readValue(...)Jackson(Javaã¨JSONã®æ©‹æ¸¡ã—å½¹)ã®ObjectMapperã‚’ä½¿ã£ã¦ã€
		//						JSONã‚’Javaã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ã¾ã™
		// request.getReader()	Postã§å—ã‘å–ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’èª­ã‚€
		// Map.class			JSONã‚’ Map<String, String> ã¨ã—ã¦èª­ã¿è¾¼ã‚€ã‚ˆã†æŒ‡å®šã™ã‚‹
		Map<String, String> inputMap = mapper.readValue(request.getReader(), Map.class);

		// å…¥åŠ›å€¤ã®åˆ†è§£ \\r?\\nã¯æ”¹è¡Œ(æ§˜ã€…ãªOSã«å¯¾å¿œã•ã›ãŸæ›¸ãæ–¹)ã€\\sã¯ç©ºç™½æ–‡å­—
		// .get()ã§æŒ‡å®šå ´æ‰€ã‚’å–å¾—ã—.trim()ã§ç©ºç™½ã‚’å–ã‚Šé™¤ãã€.slot()ã§æŒ‡å®šã—ãŸå€¤ã”ã¨ã«åˆ†å‰²ã™ã‚‹
		String[] slotLines = inputMap.get("slots").trim().split("\\r?\\n");
		String[] memberLines = inputMap.get("members").trim().split("\\r?\\n");
		String[] preferredLines = inputMap.get("preferred").trim().split("\\s*,\\s*");

		// ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŠ½å‡º
		String[] headers = slotLines[0].split("\\s*,\\s*");
		
		List<Map<String, String>> slotList = new ArrayList<>();
		
		// å„è¡Œã‚’ãƒãƒƒãƒ—å½¢å¼ã§è“„ç©
		// 1è¡Œç›®ã¯ãƒ˜ãƒƒãƒ€ãƒ¼ãªã®ã§ã€2è¡Œç›®ã‹ã‚‰é–‹å§‹
		for (int i = 1; i < slotLines.length; i++) {
			// .split()ã§ä½™åˆ†ãªç©ºç™½ã‚’å–ã‚Šé™¤ãã¤ã¤ã€
			// -1ã¨æŒ‡ç¤ºã™ã‚‹ã“ã¨ã§æœ«å°¾ãŒç©ºã§ã‚‚ç©ºæ¬„ã¨ã—ã¦èªè­˜ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹
			String[] values = slotLines[i].split("\\s*,\\s*", -1);
			// é…åˆ—ãŒç©ºã€ã‚‚ã—ãã¯1åˆ—ç›®ãŒç©ºã®å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
			if (values.length == 0 || values[0].isBlank()) continue;

			// é †ç•ªä»˜ãã®ç©ºã®Mapã‚’ç”¨æ„ã—ã¾ã™ã®ã€‚
			//ï¼ˆLinkedHashMapã¯å…¥ã‚ŒãŸé †ç•ªãŒä¿æŒã•ã‚Œã‚‹ç´ æ•µãªæ§‹é€ ï¼‰
			Map<String, String> slotData = new LinkedHashMap<>();
			// ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ•°ã ã‘ãƒ«ãƒ¼ãƒ—ã—ã¾ã™ã®ï¼ˆä¾‹ï¼š"æ—¥", "æ™‚é–“", "No"ï¼‰
			for (int j = 0; j < headers.length; j++) {
				// ã‚­ãƒ¼ã¯ãƒ˜ãƒƒãƒ€ãƒ¼ã®åå‰ã€ã¤ã¾ã‚Š "æ—¥" ã‚„ "æ™‚é–“" ãªã©
				String key = headers[j];
				// ãƒ‡ãƒ¼ã‚¿å´ï¼ˆvaluesï¼‰ã«å€¤ãŒã‚ã‚Œã°ãã‚Œã‚’ã€ãªã‘ã‚Œã° ""ï¼ˆç©ºæ–‡å­—ï¼‰ã‚’ã‚»ãƒƒãƒˆ
				String value = j < values.length ? values[j] : "";
				// Map ã« "æ—¥":"25æ—¥" ã®ã‚ˆã†ã«1ãƒšã‚¢ãšã¤è¿½åŠ ã—ã¦ã„ãã¾ã™ã®
				slotData.put(key, value);
			}
			// slotDataã®ãƒªã‚¹ãƒˆã‚’slotListã«è¿½åŠ 
			slotList.add(slotData);
		}

		// å„ªå…ˆè€…ã¨é€šå¸¸ãƒ¡ãƒ³ãƒãƒ¼ã®åŒºåˆ¥
		// å„ªå…ˆè€…ãƒªã‚¹ãƒˆã‚’ä½œæˆ
		List<String> preferred = new ArrayList<>();
		for (String name : preferredLines) {
			if (!name.isBlank()) preferred.add(name.trim());
		}

		// æŠ½é¸è€…ã‹ã‚‰å„ªå…ˆè€…ã‚’å–ã‚Šé™¤ãã€æŠ½é¸ãƒ¡ãƒ³ãƒãƒ¼ã¨ã—ã¦ä½œæˆ
		List<String> members = new ArrayList<>();
		for (String line : memberLines) {
			String trimmed = line.trim();
			// ç©ºè¡Œã‚’ç„¡è¦–ã€ã‹ã¤ã€preferredã«å…¥ã£ã¦ã„ã‚‹äººã‚’ç„¡è¦–
			if (!trimmed.isEmpty() && !preferred.contains(trimmed)) {
				members.add(trimmed);
			}
		}

		// ãƒ¡ãƒ³ãƒãƒ¼ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚·ãƒ£ãƒƒãƒ•ãƒ«
		Collections.shuffle(members);

		// å„ªå…ˆè€…ãƒªã‚¹ãƒˆã®å¾Œã«ãƒ©ãƒ³ãƒ€ãƒ ã«ã—ãŸæŠ½é¸è€…ãƒªã‚¹ãƒˆã‚’åŠ ãˆã‚‹ã“ã¨ã§ã€å…¨å“¡ã®ãƒªã‚¹ãƒˆã‚’å®Œæˆã•ã›ã‚‹
		List<String> allNames = new ArrayList<>(preferred);
		allNames.addAll(members);

		// çµæœãƒªã‚¹ãƒˆã®ç”Ÿæˆ
		List<Map<String, Object>> result = new ArrayList<>();
		int slotId = 0;

		// ã‚¹ãƒ­ãƒƒãƒˆã€åå‰ã€ã©ã¡ã‚‰ã‹ã®ä¸€è¦§ãŒç„¡ããªã£ãŸã‚‰çµ‚äº†
		for (int i = 0; i < slotList.size() && i < allNames.size(); i++) {
			Map<String, Object> entry = new LinkedHashMap<>();
			// ä¸€æ„ãªç•ªå·
			entry.put("slotId", slotId++);
			// ã‚¹ãƒ­ãƒƒãƒˆæ 
			entry.put("data", slotList.get(i));
			// åå‰æ 
			entry.put("name", allNames.get(i));
			// å„ªå…ˆãƒ¡ãƒ³ãƒãƒ¼ã‹ã©ã†ã‹ã®ãƒ•ãƒ©ã‚°(äºˆå‚™)
			entry.put("priority", preferred.contains(allNames.get(i)));
			result.add(entry);
		}

		// å‡ºåŠ›
		// å‡ºåŠ›ã‚’ã€Œæ–‡å­—åˆ—ã¨ã—ã¦ã€ã€ŒUTF-8ã§ã€å®‰å…¨ã«æ›¸ãå‡ºã™æº–å‚™ã§ã™ã‚
		PrintWriter out = new PrintWriter(response.getOutputStream(), true, StandardCharsets.UTF_8);
		// mapper.writeValueAsString(result) ã§ã€Javaã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆList<Map<String, Object>>ãªã©ï¼‰ã‚’ JSONæ–‡å­—åˆ—ã«å¤‰æ›ã€‚
		// ãã‚Œã‚’ out.print(...) ã§å‡ºåŠ›ã€‚
		out.print(mapper.writeValueAsString(result));
		// æ›¸ãå‡ºã—ãƒãƒƒãƒ•ã‚¡(ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã™ã‚‹å‰ã«ä¸€æ™‚çš„ã«ãŸã‚ã¦ãŠããƒ¡ãƒ¢ãƒª)ã«ãŸã¾ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’ å¼·åˆ¶çš„ã«å‡ºåŠ›ã€‚æ›¸ãæ¼ã‚Œé˜²æ­¢ã€‚
		out.flush();
	}
}
```

### jsp
çµæœè¡¨ç¤ºéƒ¨åˆ†ã¯JavaScriptã«ä»»ã›ã¦ã„ã¾ã™ã€‚<br>
ã‚ã‚‰ã‹ã˜ã‚ç™ºè¡¨æ ã‚¹ãƒ­ãƒƒãƒˆã«è¨˜å…¥ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã¯ã€ã“ã‚Œã‚’ä½œã‚‹ãã£ã‹ã‘ã¨ãªã£ãŸå®Ÿéš›ã«ä½¿ã†ã‚‚ã®ã€<br>
åå‰æ¬„ã«è¨˜å…¥ã•ã‚Œã¦ã„ã‚‹ã®ã¯æŸæ¼«ç”»ã®åœ’å…ã¨åœ’é•·ã®è‹—å­—ã§ã™ã€‚
```jsp
<%@ page contentType="text/html; charset=UTF-8" %>
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ç™ºè¡¨é †æŠ½é¸ã‚¢ãƒ—ãƒª</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/chusen/css/style.css">
</head>
<body>
    <h2>ç™ºè¡¨é †æŠ½é¸</h2>

    <h3>ç™ºè¡¨æ ã‚¹ãƒ­ãƒƒãƒˆå…¥åŠ›ï¼ˆ1è¡Œç›®ã¯ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œï¼‰</h3>
    <p>ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§åˆ—ã®é …ç›®ã‚’å¢—æ¸›å¯èƒ½ã§ã™ã€‚<br>
    ä¸­èº«ãŒç©ºã®ã‚»ãƒ«ã‚‚ä½œã‚Œã¾ã™ãŒã€1åˆ—ç›®ã ã‘ã¯ä½•ã‹ã—ã‚‰è¨˜å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<br>
    æœ€ä½é™ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã¨1è¡Œç›®ã®è¨ˆ2è¡Œã®è¨˜å…¥ãŒå¿…è¦ã§ã™ã€‚</p>
    <textarea id="slot-input" rows="6" cols="60">
æ—¥,æ™‚é–“,No
25æ—¥,6é™,1
ã€ƒ,,2
ã€ƒ,,3
28æ—¥,1é™,1
ã€ƒ,,2
ã€ƒ,,3
ã€ƒ,2é™,1
ã€ƒ,,2
ã€ƒ,,3
ã€ƒ,3é™,1
ã€ƒ,,2
ã€ƒ,,3
ã€ƒ,4é™,1
ã€ƒ,,2
ã€ƒ,,3
ã€ƒ,5é™,1
ã€ƒ,,2
ã€ƒ,,3
ã€ƒ,6é™,1
    </textarea>

    <h3>ç™ºè¡¨è€…ä¸€è¦§ï¼ˆ1è¡Œãšã¤ï¼‰</h3>
    <textarea id="members-input" rows="6" cols="30">
é‡åŸ
é¢¨é–“
æ¡œç”°
ä½è—¤
é«˜å€‰
    </textarea>

    <h3>å„ªå…ˆè€…ä¸€è¦§ï¼ˆ1è¡Œãšã¤ï¼‰</h3>
    <p>è¨˜å…¥ã—ãŸé †ç•ªã«ãã®ã¾ã¾çµæœã®1è¡Œç›®ã‹ã‚‰å…¥ã£ã¦ã„ãã¾ã™ã€‚<br>
    å„ªå…ˆè€…ã®ä¸­ã§ã‚‚æŠ½é¸ã‚’è¡Œã„ãŸã„å ´åˆã¯ã€å…ˆã«å„ªå…ˆè€…ã ã‘ã‚’ä¸Šã®æŠ½é¸è€…ä¸€è¦§ã«è¨˜å…¥ã—ã¦é †ç•ªã‚’æ±ºã‚ã¦ãã ã•ã„ã€‚</p>
    <textarea id="preferred-input" rows="4" cols="30">
é«˜å€‰
    </textarea>

    <br>
    <button id="start-button">æŠ½é¸ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    <button id="copy-button">çµæœã‚’ã‚³ãƒ”ãƒ¼</button>
    <a href="https://www.liqrase.net/appra.html">æˆ»ã‚‹</a>
	<br>
    <table>
        <thead>
            <tr><th></th><th></th><th></th><th>å½“é¸è€…</th></tr>
        </thead>
        <tbody id="table-body"></tbody>
    </table>

    <script src="/chusen/js/chusen.js"></script>
    <script src="/chusen/js/copy.js"></script>
</body>
</html>
```

### JavaScript
chatGPTã«å„ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’ä»˜ã‘ã¦ã‚‚ã‚‰ã£ã¦ãŠãŠã‚ˆãã«è¨˜ã—ã¦ã„ã¾ã™ã€‚<br>
æŠ½é¸æ©Ÿèƒ½
```javascript
const AudioContext = window.AudioContext || window.webkitAudioContext;
const audioCtx = new AudioContext();

let finalData = [];
let activeRandomInterval = null;

// ğŸ­ã€Šèµ·å‹•ã®å¹•é–‹ã‘ï¼šãã˜æŠ½é¸ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã€‹
document.addEventListener("DOMContentLoaded", () => {
	const startButton = document.getElementById("start-button");

	startButton.addEventListener("click", () => {
		audioCtx.resume().then(() => {
			const slotsRaw = document.getElementById("slot-input").value.trim();
			const membersRaw = document.getElementById("members-input").value.trim();
			const preferredRaw = document.getElementById("preferred-input").value.trim();

			const preferred = preferredRaw.split(/\r?\n/).map(s => s.trim()).filter(s => s);

			// ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
			fetch("/chusen/finalResult", {
				method: "POST",
				headers: { "Content-Type": "application/json" },
				body: JSON.stringify({
					slots: slotsRaw,
					members: membersRaw,
					preferred: preferred.join(",")
				})
			})
			.then(res => res.json())
			.then(data => {
				finalData = data;
				displayTable(data);
				startRandomDisplay();
				setTimeout(showFinalResults, 5000);
			});
		});
	});
});

// ğŸª‘ã€Šé…å¸­ã®å„€ï¼šæŠ½é¸ã‚¹ãƒ­ãƒƒãƒˆã¨ç©ºå¸­ã®é…ç½®ã€‹
function displayTable(data) {
	const table = document.getElementById("table-body");
	const thead = document.querySelector("thead tr");
	table.innerHTML = "";
	thead.innerHTML = "";

	if (data.length === 0) return;

	// æœ€åˆã® data ã‹ã‚‰åˆ—åã‚’å–å¾—
	const headers = Object.keys(data[0].data);

	// ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ
	headers.forEach(h => {
		const th = document.createElement("th");
		th.textContent = h;
		thead.appendChild(th);
	});

	const thName = document.createElement("th");
	thName.textContent = "åå‰ã€€ã€€";
	thead.appendChild(thName);

	// å„è¡Œ
	data.forEach(entry => {
		const tr = document.createElement("tr");

		headers.forEach(h => {
			const td = document.createElement("td");
			td.textContent = entry.data[h] || "";
			tr.appendChild(td);
		});

		const tdName = document.createElement("td");
		tdName.className = "name-cell";
		tdName.id = `cell-${entry.slotId}`;
		tdName.textContent = "ï¼Ÿï¼Ÿï¼Ÿ";
		tr.appendChild(tdName);

		table.appendChild(tr);
	});
}

// ğŸ°ã€Šé‹å‘½ã®ã‚·ãƒ£ãƒƒãƒ•ãƒ«ï¼šåå‰ãƒ©ãƒ³ãƒ€ãƒ è¡¨ç¤ºã€‹
function startRandomDisplay() {
	activeRandomInterval = setInterval(() => {
		finalData.forEach(entry => {
			const cell = document.getElementById(`cell-${entry.slotId}`);
			if (cell && !cell.classList.contains("decided")) {
				const randomName = allNames[Math.floor(Math.random() * allNames.length)];
				cell.textContent = randomName;
			}
		});
	}, 100);
	startLoopSound();
}

// ğŸŒŸã€Šç™ºè¡¨ã®æ™‚ï¼šç¢ºå®šæ¼”å‡ºã¨åå‰ã®è¡¨ç¤ºã€‹
function showFinalResults() {
	finalData.forEach((entry, i) => {
		setTimeout(() => {
			const cell = document.getElementById(`cell-${entry.slotId}`);
			if (cell) {
				cell.textContent = entry.name;
				cell.classList.add("decided");
				playDecisionSound();

				if (i === 0) {
					stopLoopSound(); // â† æœ€åˆã«ç¢ºå®šã—ãŸã¨ãã«æ­¢ã‚ã‚‹ï¼
				}
			}
			if (i === finalData.length - 1) {
				clearInterval(activeRandomInterval);
			}
		}, i * 500);
	});
}

let loopingOsc = null;
let loopIntervalId = null;

// ğŸ”Šã€Šé¼“å‹•ã®éŸ³ï¼šé€£æ‰“ã•ã‚Œã‚‹ã‚½ã®éŸ³ã€‹
function startLoopSound() {
	stopLoopSound(); // äºŒé‡èµ·å‹•é˜²æ­¢
	loopIntervalId = setInterval(() => {
		const osc = audioCtx.createOscillator();
		const gain = audioCtx.createGain();

		// éŸ³è‰²ã‚’æ±ºã‚ã‚‹
		osc.type = "square";
		// éŸ³ã®é«˜ã•ã‚’æ±ºã‚ã‚‹
		osc.frequency.setValueAtTime(783.99, audioCtx.currentTime); // ã‚½ï¼ˆG5ï¼‰
		gain.gain.setValueAtTime(0.05, audioCtx.currentTime);

		osc.connect(gain);
		gain.connect(audioCtx.destination);

		osc.start();
		// 0.08ç§’ã ã‘é³´ã‚‰ã™ï¼ˆã‚½ãƒƒï¼‰
		osc.stop(audioCtx.currentTime + 0.08); 

	// 120msã”ã¨ã«é€£æ‰“ â†’ ã‚½ã‚½ã‚½ã‚½ã‚½ã‚½ï¼
	}, 120); 
}

// ğŸŒ™ã€Šé™å¯‚ã®è¨ªã‚Œï¼šãƒ«ãƒ¼ãƒ—éŸ³åœæ­¢ã€‹
function stopLoopSound() {
	if (loopIntervalId !== null) {
		clearInterval(loopIntervalId);
		loopIntervalId = null;
	}
}

// ğŸ¶ã€Šç¢ºå®šã®ãƒ•ã‚¡ãƒ³ãƒ•ã‚¡ãƒ¼ãƒ¬ï¼šãƒ‰ã¨é«˜ã„ãƒ‰ã®å’ŒéŸ³ã€‹
function playDecisionSound() {
	const osc1 = audioCtx.createOscillator();
	const osc2 = audioCtx.createOscillator();
	const gainNode = audioCtx.createGain();

	// éŸ³è‰²ã‚’æ±ºã‚ã‚‹
	osc1.type = "square";
	osc2.type = "square";
	// éŸ³ã®é«˜ã•ã‚’æ±ºã‚ã‚‹
	osc1.frequency.setValueAtTime(523.25*2, audioCtx.currentTime); // ãƒ‰
	osc2.frequency.setValueAtTime(523.25, audioCtx.currentTime); // ãƒ‰
	// éŸ³é‡ãŒå¤§ãããªã‚Šã™ããªã„ã‚ˆã†ã«ã™ã‚‹
	gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);

	osc1.connect(gainNode);
	osc2.connect(gainNode);
	gainNode.connect(audioCtx.destination);

	osc1.start();
	osc2.start();
	osc1.stop(audioCtx.currentTime + 0.2);
	osc2.stop(audioCtx.currentTime + 0.2);
}

// ãƒ©ãƒ³ãƒ€ãƒ è¡¨ç¤ºç”¨åå‰ãƒªã‚¹ãƒˆï¼ˆæ—¥æœ¬ã«å¤šã„è‹—å­—Top30ï¼‰
const allNames = [
	"ä½è—¤", "éˆ´æœ¨", "é«˜æ©‹", "ç”°ä¸­", "ä¼Šè—¤", "æ¸¡è¾º", "å±±æœ¬", "ä¸­æ‘", "å°æ—", "åŠ è—¤",
	"å‰ç”°", "å±±ç”°", "ä½ã€…æœ¨", "å±±å£", "æ¾æœ¬", "äº•ä¸Š", "æœ¨æ‘", "æ—", "æ–è—¤", "æ¸…æ°´",
	"å±±å´", "æ£®", "æ± ç”°", "æ©‹æœ¬", "é˜¿éƒ¨", "çŸ³å·", "å±±ä¸‹", "ä¸­å³¶", "çŸ³äº•"
];
```

æŠ½é¸çµæœã‚³ãƒ”ãƒ¼æ©Ÿèƒ½
```javascript
document.getElementById("copy-button").addEventListener("click", () => {
	if (finalData.length === 0) {
		alert("ã¾ã çµæœãŒã‚ã‚Šã¾ã›ã‚“ã€‚æŠ½é¸ã‚’ã—ã¦ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã‚’ã—ã¦ãã ã•ã„ã€‚");
		return;
	}

	const headers = Object.keys(finalData[0].data).concat("ç™ºè¡¨è€…");
	const lines = [];

	// ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ
	lines.push(headers.join("\t"));

	// å„ãƒ‡ãƒ¼ã‚¿è¡Œ
	finalData.forEach(entry => {
		const values = headers.map(h => {
			if (h === "ç™ºè¡¨è€…") return entry.name;
			return entry.data[h] || "";
		});
		lines.push(values.join("\t"));
	});

	const text = lines.join("\n");

	navigator.clipboard.writeText(text).then(() => {
		alert("ã‚³ãƒ”ãƒ¼å®Œäº†â™ª Excelã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚");
	}).catch(err => {
		alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã„ãŸã—ã¾ã—ãŸã‚â€¦â€¦ " + err);
	});
});
```

### CSS
ã»ã¼chatGPTä»»ã›
```css
@charset "UTF-8";

body {
	font-family: 'Segoe UI', 'ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ ProN', 'ãƒ¡ã‚¤ãƒªã‚ª', sans-serif;
	background-color: #f5faff;
	margin: 20px;
	color: #333;
}

h2, h3 {
	color: #2a4d69;
	margin-top: 20px;
}

textarea {
	width: 90%;
	max-width: 400px;
	font-size: 1rem;
	font-family: monospace;
	padding: 8px;
	margin-bottom: 10px;
	border: 1px solid #ccc;
	border-radius: 6px;
	box-shadow: 2px 2px 4px rgba(0,0,0,0.1);
	resize: vertical;
}

button,a {
	color:#001858;
	background-color: #0000;
	border: 1.4px solid #999;
	cursor: pointer;
	border-radius: 5px;
	font-size: .9rem;
	padding: 6px 8px;
	margin:0 5px;
	text-decoration: none;
}

button:hover,a:hover {
	background-color: #ffb6c1;
}

table {
	width: 90%;
	max-width: 500px;
	border-collapse: collapse;
	margin-top: 20px;
	margin-left: 10px;
	font-size: 1rem;
	box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

thead th {
	background-color: #e3f2fd;
	padding: 5px;
	border: 1px solid #ddd;
	text-align: left;
}

tbody td {
	padding: 5px;
	border: 1px solid #ddd;
}

.name-cell {
/*    font-weight: bold;*/
	text-align: center;
}

.name-cell.decided {
	background-color: #9edd8d;
	color: #002100;
}
```

ä»¥ä¸Šã§ã™ã€‚